jQuery((function(t){t.productsVariations=function(e){const n=t(e),o=new The7ElementorSettings(n);let i={},a={};t.data(e,"productsVariations",n),i={init:function(){if(elementorFrontend.isEditMode())return;n.find("[data-product_variations]").each((function(){const e=t(this),n=e.data("post-id"),r=e.data("product_variations"),s=e.find(".products-variations"),c=e.find(".box-button"),u=e.find("span.price"),d=i.findOutOfStockAttributes(r);a[n]={state:{},variations:r,outOfStockAttributes:d,$addToCartButton:c,$variations:s,$originPrice:u.clone(),$price:u},i.makeOutOfStockAttributesVisible(s,d),s.find("li a").data("the7_product_data",a[n]),c.attr("data-product_id",""),c.on("click",(function(e){const n=t(this);if("n"==o.getCurrentDeviceSetting("show_variations"))return e.preventDefault(),void window.location.assign(n.attr("href"));n.is(".variation-btn-disabled")&&e.preventDefault()}))}));const e=n.find(".products-variations li a");if(t(".touchevents").length){let n,o;e.on("touchstart",(function(t){n=t.originalEvent.touches[0].pageY,o=t.originalEvent.touches[0].pageX})),e.on("touchend",(function(e){e.preventDefault();let a=e.originalEvent.changedTouches[0].pageX,r=e.originalEvent.changedTouches[0].pageY;if(n===r||o===a){const e=t(this);i.chooseVariations(e)}}))}else e.on("click",(function(e){e.preventDefault();const n=t(this);i.chooseVariations(n)}));if(!!t("html.mobile-true").length){const e=n.find(".trigger-img-hover");e.each((function(){const a=t(this);let r,s;if(a.hasClass("woo-ready"))return;const c=!!a.closest(".product-type-variable",n).length;a.on("touchstart",(function(t){r=t.originalEvent.touches[0].pageY,s=t.originalEvent.touches[0].pageX})),a.on("touchend",(function(n){const a=t(this),u=n.originalEvent.changedTouches[0].pageX,d=n.originalEvent.changedTouches[0].pageY,l=!a.hasClass("is-clicked");let f=l;if(l){let l;if(a.hasClass("woo-buttons-on-img"))l=!0;else{const t=a.find(".woo-buttons-on-img").get(0);l=n.originalEvent&&t&&n.originalEvent.composedPath().includes(t)}if(l&&t(n.target).closest(".products-variations-wrap, .woo-list-buttons",a).length){const t=o.getCurrentDeviceSetting("show_variations_on_hover"),e=o.getCurrentDeviceSetting("show_btn_on_hover");(!c||t&&"on-hover"!==t)&&(e&&"on-hover"!==e)&&(f=!1)}if(r==d||s==u){e.removeClass("is-clicked"),a.addClass("is-clicked");const t={boundaryElement:a.get(0),$affectedElements:e};elementorFrontend.elements.$body.off("touchstart",i.onOuterTouchHandler).on("touchstart",t,i.onOuterTouchHandler)}}f&&n.preventDefault()})),a.addClass("woo-ready")}))}},chooseVariations:function(e){if(e.is(".out-of-stock")||"n"===o.getCurrentDeviceSetting("show_add_to_cart"))return;const n=e.parent(),a=e.data("id"),r=e.closest("ul").attr("data-atr"),s=e.data("the7_product_data");n.hasClass("active")?(n.removeClass("active"),s.state[r]=""):(n.siblings().removeClass("active"),n.addClass("active"),s.state[r]=String(a));let c=Object.assign({},s.outOfStockAttributes);i.findMatchingOutOfStockVariations(s.variations,s.state).forEach((function(t){for(const[e,n]of Object.entries(t.attributes))s.state[e]!==n&&(c[e]=c[e].slice()||[],-1===c[e].indexOf(n)&&c[e].push(n))})),i.makeOutOfStockAttributesVisible(s.$variations,c);const u=i.findMatchingVariation(s.variations,s.state);u?(s.$addToCartButton.attr("data-product_id",u.variation_id),s.$addToCartButton.removeClass("variation-btn-disabled"),u.price_html&&i.updateProductPriceData(s,t(u.price_html))):(s.$addToCartButton.attr("data-product_id",""),s.$addToCartButton.addClass("variation-btn-disabled"),i.updateProductPriceData(s,s.$originPrice.clone()))},makeOutOfStockAttributesVisible:function(t,e){const n=t.find("li a");n.removeClass("out-of-stock");for(const[t,o]of Object.entries(e))if(o.length){const e=o.slice().map((function(e){return"."+t+"_"+e})).join(",");n.filter(e).addClass("out-of-stock")}},onOuterTouchHandler:function(t){t.originalEvent&&t.data&&t.data.boundaryElement&&!t.originalEvent.composedPath().includes(t.data.boundaryElement)&&t.data.$affectedElements&&t.data.$affectedElements.removeClass("is-clicked")&&elementorFrontend.elements.$body.off("touchstart",i.onOuterTouchHandler)},findMatchingOutOfStockVariations:function(t,e){for(var n=[],o=0;o<t.length;o++){var i=t[o];!i.is_in_stock&&this.isMatch(i.attributes,e)&&n.push(i)}return n},isMatch:function(t,e){var n=!1;for(var o in t)if(t.hasOwnProperty(o)){var i=t[o],a=e[o];void 0!==i&&void 0!==a&&0!==i.length&&0!==a.length&&i===a&&(n=!0)}return n},findMatchingVariation:function(t,e){for(var n=[],o=0;o<t.length;o++){var i=t[o];this.isExactMatch(i.attributes,e)&&n.push(i)}return n.shift()},isExactMatch:function(t,e){var n=!0;for(var o in t)if(t.hasOwnProperty(o)){var i=t[o],a=e[o];(void 0===i||void 0===a||0===a.length||0!==i.length&&i!==a)&&(n=!1)}return n},updateProductPriceData:function(t,e){t.$price.replaceWith(e),t.$price=e},findOutOfStockAttributes:function(t){let e=[],n=[],o={};for(let o=0;o<t.length;o++){let i=t[o];i.is_in_stock?e.push(Object.entries(i.attributes)):n.push(Object.entries(i.attributes))}e=[].concat(...e),n=[].concat(...n);const i=function(t,e){const n=e[0],o=e[1];return t[n]=t[n]||[],t[n].push(o),t},a=e.reduce(i,{}),r=n.reduce(i,{});for(const[t,e]of Object.entries(r))a[t]&&(o[t]=e.filter((function(e){return!a[t].includes(e)})));return o}},i.init()},t.fn.productsVariations=function(){return this.each((function(){void 0!==t(this).data("productsVariations")&&t(this).removeData("productsVariations"),new t.productsVariations(this)}))}})),jQuery(window).on("elementor/frontend/init",(function(){const t=function(t,e){e((function(){t.productsVariations()}))};elementorFrontend.hooks.addAction("frontend/element_ready/the7-wc-products.default",t),elementorFrontend.hooks.addAction("frontend/element_ready/the7-wc-products-carousel.default",t)}));